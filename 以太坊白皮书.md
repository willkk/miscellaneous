# 下一代智能合约及去中心化应用平台
中本聪2009开发的比特币是第一种没有实物支撑或内在价值，没有中心发行者的数字资产。比特币中实现分布式共识的底层区块链技术很快吸引了大家更多的注意力。经常提到的区块链应用包括：使用链上数字资产表示自定义的货币及金融工具（colored coin），底层物理设备的所有权（smart property），不可替代资产如域名（Namecoin）以及更复杂的应用，包括实现任意规则的代码直接控制的数字资产（smart contract）或者基于区块链的去中心化自治组织（DAOs）。Ethereum打算提供的是一个内置成熟的图灵完备的编程语言的区块链，这种编程语言可以用于创建合约，用来编码任意的状态转换函数，允许用户创建以上提到的任何系统以及很多其他的暂时想不到的。(注：从这里看出，以太坊的作者希望整合当时各种分布式代币系统的特性，建立一个通用的、具有图灵完备的智能合约编程语言的分布式应用平台)


# 目录
- 比特币及现有概念介绍
  - 历史
  - 比特币中的状态转换系统
  - 挖矿
  - Merkle树
  - 其他区块链应用
  - 脚本
- 以太坊（Ethereum）
  - 哲学
  - 以太坊账户
  - 消息和交易
  - 消息
  - 以太坊状态转换函数
  - 代码执行
  - 区块链和挖矿
- 应用
  - 代币系统
  - 金融衍生品及稳值货币
  - 身份和信用体系
  - 去中心化文件存储
  - 去中心化自治组织
  - 更多的应用
- 其他及问题
  - 改进的GHOST实现
  - 费用
  - 计算和图灵完备
  - 货币和保险
  - 挖矿中心化
  - 伸缩性
- 结论
- 备注及进一步阅读

# 比特币及现有概念介绍
## 历史
去中心化数字货币以及其他应用像财产登记已经存在几十年了。1980和1990年代的匿名电子现金协议，主要依赖于类似乔母盲签（Chaumian blinding）等加密原语，提供了一种高度隐私的货币，但由于对中心化中介机构的依赖使得它没有受到普遍欢迎。1998年，戴伟的b-money成为第一个引入通过解决计算难题及去中心化共识来发币的主意的提议。但他的提议缺少去中心化共识如何实现的细节。2005年，Hal Finney引入了“可复用工作量证明”的概念，该系统借鉴了b-money以及Adam Back的计算困难的Hashcash难题，但依然依赖于可信计算作为后端支持。2009年，中本聪（Satoshi Nakamoto）第一次真正实现了去中心化货币，他结合了通过公钥加密来管理所有权的原语及跟踪币的流动的共识算法（称为“工作量证明proof of work”）。
工作量证明机制是该领域的一个突破，因为它同时解决了两个问题。第一，它提供了一个简单但又相对有效的共识算法，允许网络中的节点一起表决一组公认的比特币账本状态更新；第二，它提供了一个机制，允许自由进入共识过程，解决了谁可以影响共识的政治问题，同时阻止了女巫攻击。能阻止攻击的原因是它为每个参与的节点设置了一个门槛，比如要求注册成唯一的实体，加入经济因素的门槛--每个节点的投票权重正比于节点自身的计算力。之后，另一种称为proof of stake的方法被提出来，它计算每个节点的权重正比于该节点的持币量，而不是计算资源。
## 比特币中的状态转换系统
![](https://raw.githubusercontent.com/ethereumbuilders/GitBook/master/en/vitalik-diagrams/statetransition.png)
从技术角度来说，比特币这样的加密货币账本可以被看做一个状态转换系统。其中“状态”包含所有现存比特币的所有权状态，“状态转换函数”输入一个状态和交易并输出新的状态结果。例如，在标准的银行系统中，状态就是余额表，交易就是从A转移$X到B的请求，而状态转换函数从A账户减去$X并向B增加$X。如果A最初就没有$X那么多，状态转换函数就返回错误。形式上可以做如下定义：
```go
APPLY(S,TX) -> S' or ERROR
上面的银行系统中：
APPLY({ Alice: $50, Bob: $50 },"send $20 from Alice to Bob") = { Alice: $30, Bob: $70 }
或者
APPLY({ Alice: $50, Bob: $50 },"send $70 from Alice to Bob") = ERROR
```
比特币中的“状态”是所有已挖出但未消费的比特币的集合（技术上称为“未花费交易输出”，即UTXO），其中每一个UTXO都有一个面额和所有者。一个交易可以有多个输入和一个或多个输出，每个输入都引用了一个UTXO和私钥加密签名，而每个输出都包含一个UTXO并被加入到“状态”中。
状态转换函数APPLY(S,TX) -> S'可以大致被定义为：

1.对于每一个输入Tx：  
  - 如果引用的UTXO不在S中，返回错误。
  - 如果提供的签名与UTXO的所有者不匹配，返回错误。  
2.如果所有输入的UTXO的面额总额小于所有输出UTXO的面额总额，返回错误。  
3.移除所有的输入UTXO，增加所有输出UTXO，返回S'。  

举例来说，Alice要向Bob转11.7比特币。首先，Alice先查找她拥有的总额不少于11.7比特币的可用的一组UTXO。实际情况，Alice可能并不能正好获得11.7比特币，比如，可能获取到最低可用的6+4+2=12比特币。她然后创建以这三个UTXO作为输入和两个输出的交易，第一个输出是Bob作为所有者的11.7比特币，第二个输出是剩下的0.3个比特币“零钱”，所有者是Alice。
## 挖矿


## 参考文献：
1.	白皮书 https://github.com/ethereum/wiki/wiki/White-Paper









